"use strict";(self.webpackChunkgravityflow=self.webpackChunkgravityflow||[]).push([[715],{3068:function(t,n,e){e.r(n),e.d(n,{default:function(){return tn}});var i=e(9475),o={},a={activeGrid:"",actionData:[],actionMenuOpen:!1,activeAction:null,activeActionKey:"",activeActionNote:"",activeActionSubmitType:"",activeActionTrigger:null,activeGridNode:null,activeRowNode:null,cleanDocTitle:document.title||"",dragging:!1,latestUpdateData:{},newRowsOnUpdate:0,notificationShown:!1,openInNewTab:!1,previousRowCount:0,pushEnabled:!1},c={refreshTimers:{},grids:{},gridOptions:{},flyouts:{},notifications:{}},r=function(t){var n=t.delegateTarget.parentNode.dataset.gridId;c.gridOptions[n].api.setFilterModel(null)},s={activeGrid:null},d=function(){document.body.classList.remove("gflow-grid--fullscreen-active"),i.qg.unlock(),s.activeGrid.style.left="".concat(s.activeGrid.dataset.left,"px"),s.activeGrid.style.top="".concat(s.activeGrid.dataset.top,"px"),s.activeGrid.style.width="".concat(s.activeGrid.dataset.width,"px"),s.activeGrid.style.height="".concat(s.activeGrid.dataset.height,"px"),setTimeout((function(){var t=(0,i.v$)("gflow-grid-placeholder")[0];t.parentNode.removeChild(t),s.activeGrid.classList.remove("gflow-grid--animate"),s.activeGrid.classList.remove("gflow-grid--fullscreen"),s.activeGrid.style.left="",s.activeGrid.style.top="",s.activeGrid.style.width="",s.activeGrid.style.height=""}),400)},l=function(t){var n;s.activeGrid=t.delegateTarget.parentNode.parentNode.parentNode,s.activeGrid.classList.contains("gflow-grid--fullscreen")?d():(n=s.activeGrid.getBoundingClientRect(),s.activeGrid.insertAdjacentHTML("beforebegin",'<div data-js="gflow-grid-placeholder" style="height: '.concat(n.height,'px"></div>')),s.activeGrid.setAttribute("data-top",n.top),s.activeGrid.setAttribute("data-left",n.left),s.activeGrid.setAttribute("data-height",n.height),s.activeGrid.setAttribute("data-width",n.width),s.activeGrid.style.left="".concat(n.left,"px"),s.activeGrid.style.top="".concat(n.top,"px"),s.activeGrid.style.width="".concat(n.width,"px"),s.activeGrid.style.height="".concat(n.height,"px"),s.activeGrid.classList.add("gflow-grid--fullscreen"),setTimeout((function(){var t=document.body.classList.contains("admin-bar")?32:0;s.activeGrid.classList.add("gflow-grid--animate"),s.activeGrid.style.left="0",s.activeGrid.style.top="".concat(t,"px"),s.activeGrid.style.width="100%",s.activeGrid.style.height="calc(100% - ".concat(t,"px)")}),25),setTimeout((function(){document.body.classList.add("gflow-grid--fullscreen-active"),i.qg.lock(!1)}),400))},u=function(t){s.activeGrid&&"Escape"===t.key&&s.activeGrid.classList.contains("gflow-grid--fullscreen")&&d()},g=e(6796),f=e(3345),v=e.n(f),p="inbox_default",h={animateRows:!1},w=(null===v()||void 0===v()?void 0:v().grids)||{},m=function(t){var n=[];return c.gridOptions[t].api.forEachNode((function(t){return n.push(t.data.id)})),n},b=function(t){var n=t.delegateTarget,e=(0,i.As)(n,'[data-js="gflow-inbox"]');return _(e)},_=function(t){return t.dataset.gridId||p},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.api.forEachNode((function(e){Number(e.data.id)===Number(n)&&(t.rowData.splice(e.rowIndex,1),t.api.setRowData(t.rowData))}))},x=function(t){var n=t.delegateTarget,e=b(t);c.gridOptions[e].api.setQuickFilter(n.value)},k=function(t){var n=b(t);c.gridOptions[n].api.setQuickFilter(null)},A=e(7083),O=e(9137),j=e(5952),T=e(586),M=(null===v()||void 0===v()?void 0:v().default_date_format)||"d/m/Y",G=function(){function t(){(0,O.Z)(this,t)}return(0,j.Z)(t,[{key:"init",value:function(t){this.params=t,this.eGui=document.createElement("div"),this.eGui.setAttribute("role","presentation"),this.eGui.classList.add("ag-input-wrapper"),this.eGui.classList.add("custom-date-filter"),this.eGui.innerHTML='\n\t\t\t<input type="text" data-input style="width: 100%;" />\n\t\t\t<a class="ag-grid__date-toggle" title="toggle" data-toggle>\n\t\t        <i class="gflow-icon gflow-icon--calendar"></i>\n\t\t    </a>\n\t\t\n\t\t    <a class="ag-grid__date-clear-toggle" title="clear" data-clear>\n\t\t        <i class="gflow-icon gflow-icon--x"></i>\n\t\t    </a>\n\t\t',this.eInput=this.eGui.querySelector("input"),this.picker=(0,T.Z)(this.eGui,{onChange:this.onDateChanged.bind(this),dateFormat:M,wrap:!0}),this.picker.calendarContainer.classList.add("ag-custom-component-popup"),this.date=null}},{key:"getGui",value:function(){return this.eGui}},{key:"onDateChanged",value:function(t){this.date=t[0]||null,this.params.onDateChanged()}},{key:"getDate",value:function(){return this.date}},{key:"setDate",value:function(t){this.picker.setDate(t),this.date=t}},{key:"setInputPlaceholder",value:function(){this.eInput.setAttribute("placeholder",M)}}]),t}(),N=e(6655),E=e.n(N),L={gridMutationEvents:["onModelUpdated","onColumnResized","onColumnVisible","onDragStopped"],openNewTabKeycodes:[16,17,91,93]},I=function(t){-1!==L.openNewTabKeycodes.indexOf(t.which)&&("keydown"===t.type?a.openInNewTab=!0:a.openInNewTab=!1)},D=e(5311),C=e.n(D),S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.openInNewTab?(0,i.RB)(t):window.location.href=t};function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"gform-input",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"gform-input",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return'\n\t<input \n\t\tclass="'.concat(o,'" \n\t\tvalue="').concat(i,'" \n\t\ttype="').concat(t,'" \n\t\tdata-js="').concat(a,'"\n\t\t').concat(c?'placeholder="'.concat(c,'"'):"","\n\t\t").concat(n?'id="'.concat(n,'"'):"","\n\t\t").concat(e?'name="'.concat(e,'"'):"","\n\t/>\n\t")}function R(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"gform-field__toggle",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"gform-toggle";return'\n\t<div class="'.concat(a,'">\n\t\t<span class="gform-settings-input__container">\n\t\t\t<input \n\t\t\t\ttype="checkbox" \n\t\t\t\tclass="gform-field__toggle-input" \n\t\t\t\tdata-js="').concat(c,'" \n\t\t\t\t').concat(t?"id=".concat(t):"","\n\t\t\t\t").concat(n?"name=".concat(n):"","\n\t\t\t\t").concat(e?"checked":"",'\n\t\t\t>\n\t\t\t<label class="gform-field__toggle-container" ').concat(t?"for=".concat(t):"",'>\n\t\t\t\t<span \n\t\t\t\t\tclass="gform-field__toggle-switch-text screen-reader-text"\n\t\t\t\t\tdata-disabled-text="').concat(i,'"\n\t\t\t\t\tdata-enabled-text="').concat(o,'"\n\t\t\t\t>').concat(e?o:i,'</span>\n\t\t\t\t<span class="gform-field__toggle-switch"></span>\n\t\t\t</label>\n\t\t</span>\n\t</div>\n\t')}var P=(null===v()||void 0===v()?void 0:v().i18n)||{},H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return'\n\t<span class="gform-flyout__setting-label">\n\t\t'.concat(P.settings_push_title,'\n\t</span>\n\t<span class="gform-flyout__setting-desc">\n\t\t').concat(P.settings_push_desc,"\n\t</span>\n\t").concat(R("inbox-setting--push-enabled","inbox-setting--push-enabled",t.push_enabled,P.disabled,P.enabled,"gform-field__toggle gform-flyout__setting","inbox-setting"),"\n\t")},U=window.gravityflow_inbox_strings||{},Z=function(){function t(){(0,O.Z)(this,t)}return(0,j.Z)(t,[{key:"init",value:function(t){var n=t.value;n&&n.actions.length&&(a.actionData.push({entryId:n.entryId,entryUrl:t.data.url_entry,actions:n.actions}),this.eGui=document.createElement("div"),this.eGui.classList.add("gflow-grid__actions-container"),this.eGui.innerHTML=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return'<button \n\t\tclass="gflow-grid__actions-trigger gflow-icon gflow-icon--more-vertical" \n\t\taria-label="'.concat(P.view_quick_actions,'"\n\t\tdata-js="gflow-quick-actions-trigger"\n\t\tdata-id="').concat(t,'"\n\t\tdata-url="').concat(n,'"\n\t></button>')}(n.entryId,t.data.url_entry))}},{key:"getGui",value:function(){return this.eGui}}]),t}(),F=function(t){t.parentNode.removeChild(t),o.activeActionMenu&&(o.activeActionMenu.classList.remove("gflow-grid__actions-menu--ajax-running"),o.activeActionMenu.classList.remove("gflow-grid__actions-menu--ajax-action-".concat(a.activeActionSubmitType)))},$=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=(0,i.v$)("gform-loading-mask")[0];t?(o.activeActionMenu.classList.add("gflow-grid__actions-menu--ajax-success"),setTimeout((function(){o.activeActionMenu.classList.add("gflow-grid__actions-menu--fade-out"),setTimeout((function(){"Enter"===a.activeActionKey&&a.activeRowNode.nextElementSibling&&(0,i.v$)(".ag-cell",!1,a.activeRowNode.nextElementSibling,!0)[0].focus({preventScroll:!0}),y(c.gridOptions[a.activeGrid],a.activeActionMenuEntryId),F(n),Q()}),400)}),600)):F(n)},z=function(){C().ajax({method:"POST",url:"".concat(null==U?void 0:U.restUrl,"gf/v2/entries/").concat(a.activeActionMenuEntryId,"/workflow/approvals"),data:{action:a.activeActionSubmitType,gravityflow_note:o.activeActionMenuNote.value},beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",null==U?void 0:U.nonce),o.activeActionMenu.classList.add("gflow-grid__actions-menu--ajax-running"),o.activeActionMenu.classList.add("gflow-grid__actions-menu--ajax-action-".concat(a.activeActionSubmitType)),document.body.insertAdjacentHTML("beforeend",'\n\t<div class="gflow-inbox__loading-mask" data-js="gform-loading-mask"></div>\n')},success:function(t){"success"===t.status?$():($(!1),alert(t.feedback))},fail:function(t){$(!1),alert(t)}})},J=function(t){var n=t.delegateTarget,e=n.dataset.action,i=n.dataset.requiresNote;"edit"===e?S(n.dataset.url):"approve"!==e&&"reject"!==e||(a.activeActionSubmitType=e,function(){"true"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")?(o.activeActionMenuNote.focus(),o.activeActionMenu.classList.add("gflow-grid__actions-menu--note-active")):z()}(i,n))},K=function(){o.activeActionMenuSubmit.disabled=o.activeActionMenuNote.value.trim().length<=0},X=function(t){if("cancel"===t.delegateTarget.dataset.action)return o.activeActionMenuNote.value="",o.activeActionMenuSubmit.disabled=!0,void o.activeActionMenu.classList.remove("gflow-grid__actions-menu--note-active");z()},W=function(){var t=document.getElementById("wpadminbar"),n=t?t.offsetHeight:0,e=(0,i.r7)(a.activeAction);if(window.innerHeight-e.bottom-o.activeActionMenu.offsetHeight<20){var c=document.body.classList.contains("gflow-grid--fullscreen-active")?a.activeAction.offsetHeight:0;o.activeActionMenu.style.marginTop="-".concat(c+o.activeActionMenu.offsetHeight,"px"),o.activeActionMenu.style.top="".concat(e.top+a.activeAction.offsetHeight-n,"px")}else{var r=document.body.classList.contains("gflow-grid--fullscreen-active")?a.activeAction.offsetHeight:2*a.activeAction.offsetHeight;o.activeActionMenu.style.top="".concat(e.top+r-n,"px")}o.activeActionMenu.style.left="".concat(e.left,"px")},B=function(t){return(0,i.iu)(t,a.activeAction,o.activeActionMenu,Q)},Q=function(){o.activeActionMenu.parentNode.removeChild(o.activeActionMenu),a.activeAction=null,o.activeActionMenu=null,a.actionMenuOpen=!1},V=function(t){var n=t.delegateTarget,e=Number(n.dataset.id),c=n.dataset.url,r=a.actionData.filter((function(t){return Number(t.entryId)===e}))[0];a.activeActionKey=t.key,a.activeGridNode=(0,i.As)(n,'[data-js="gflow-inbox"]'),a.activeRowNode=(0,i.As)(n,".ag-row"),a.activeGrid=a.activeGridNode.dataset.gridId,a.actionMenuOpen&&a.activeAction!==n&&Q(),a.actionMenuOpen?Q():(a.activeAction=n,function(t,n,e,c){a.actionMenuOpen=!0,a.activeActionMenuEntryId=t,a.activeActionMenuEntryUrl=e;var r=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return'<article class="gform-admin gflow-grid__actions-menu" data-js="gflow-quick-actions-menu">\n\t\t<div class="gflow-grid__actions-menu-row">\n\t\t\t<button \n\t\t\t\tclass="gflow-grid__actions-menu-trigger" \n\t\t\t\tdata-js="gflow-quick-actions-menu-trigger" \n\t\t\t\tdata-action="edit"\n\t\t\t\tdata-url="'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",'"\n\t\t\t>\n\t\t\t\t').concat(P.view_entry,"\n\t\t\t</button>\n\t\t</div>\n\t\t").concat(t.map((function(t){return'\n\t\t\t\t\t<div class="gflow-grid__actions-menu-row">\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\tclass="gflow-grid__actions-menu-trigger gflow-grid__actions-menu-trigger--'.concat(t.key,'"\n\t\t\t\t\t\t\tdata-js="gflow-quick-actions-menu-trigger" \n\t\t\t\t\t\t\tdata-action="').concat(t.key,'"\n\t\t\t\t\t\t\tdata-requires-note="').concat(t.show_note_field,'"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t').concat(t.label,'\n\t\t\t\t\t\t\t<span class="gform-loader--spin">').concat(P.loading,'</span>\n\t\t\t\t\t\t\t<i class="gflow_grid__actions-icon-success gflow-icon gflow-icon--check"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>')})).join(""),'\n\t\t<div class="gflow-grid__actions-menu-note">\n\t\t\t<span class="gflow-grid__actions-menu-heading">').concat(P.actions_menu_heading,'</span>\n\t\t\t<textarea class="gflow-grid__actions-menu-textarea" data-js="gflow-quick-actions-menu-note"></textarea>\n\t\t\t<div class="gflow-grid__actions-menu-footer">\n\t\t\t\t<button \n\t\t\t\t\tclass="gform-button gform-button--white gform-button--size-sm gflow_grid__actions-menu-submit" \n\t\t\t\t\tdata-js="gflow-quick-actions-menu-note-action" \n\t\t\t\t\tdata-action="submit"\n\t\t\t\t\tdisabled="disabled"\n\t\t\t\t>\n\t\t\t\t\t').concat(P.submit,'\n\t\t\t\t\t<span class="gform-loader--spin">').concat(P.loading,'</span>\n\t\t\t\t\t<i class="gflow_grid__actions-icon-success gflow-icon gflow-icon--check"></i>\n\t\t\t\t</button>\n\t\t\t\t<button \n\t\t\t\t\tclass="gform-button gform-button--white gform-button--size-sm gform-button--no-border" \n\t\t\t\t\tdata-js="gflow-quick-actions-menu-note-action"\n\t\t\t\t\tdata-action="cancel"\n\t\t\t\t>').concat(P.cancel,"</button>\n\t\t\t</div>\n\t\t</div>\n\t</article>")}(e,n.actions);document.body.insertAdjacentHTML("beforeend",r),o.activeActionMenu=(0,i.v$)("gflow-quick-actions-menu")[0],o.activeActionMenuNote=(0,i.v$)("gflow-quick-actions-menu-note",!1,o.activeActionMenu)[0],o.activeActionMenuSubmit=(0,i.v$)('[data-js="gflow-quick-actions-menu-note-action"][data-action="submit"]',!1,o.activeActionMenu,!0)[0],"Enter"===c.key&&(0,i.v$)("gflow-quick-actions-menu-trigger",!1,o.activeActionMenu)[0].focus({preventScroll:!0}),W(),o.activeActionMenu.addEventListener("keydown",B)}(e,r,c,t))},Y=function(t){a.actionMenuOpen&&(t.target===(0,i.v$)("gform-loading-mask")[0]||t.target===a.activeAction||o.activeActionMenu.contains(t.target)||Q())},tt=function(){a.actionMenuOpen&&W()},nt=function(t){c.gridOptions[t].onGridReady=function(n){return function(t,n){!function(t){var n=i.Xb.get(t);if(n){var e=JSON.parse(n).map((function(t){return t.colId})).sort(),o=c.gridOptions[t].columnDefs.map((function(t){return t.field})).sort();(0,i._g)(e,o)?(n=JSON.parse(n).sort((function(t){return"id"===t.colId?-1:0})),c.gridOptions[t].columnApi.applyColumnState({state:n,applyOrder:!0})):c.gridOptions[t].api.sizeColumnsToFit()}else c.gridOptions[t].api.sizeColumnsToFit()}(n)}(0,t)},c.gridOptions[t].onCellClicked=function(t){return function(t){a.dragging||"actions"===t.column.colId||S(t.data.url_entry)}(t)},c.gridOptions[t].onCellKeyPress=function(t){return function(t){"Enter"===t.event.key&&("actions"!==t.column.colId?S(t.data.url_entry):function(t){var n=(0,i.v$)("gflow-quick-actions-trigger",!1,t.event.target)[0];n&&V({delegateTarget:n,key:"Enter"})}(t))}(t)},L.gridMutationEvents.forEach((function(n){c.gridOptions[t][n]=E()((function(n){return function(t,n){var e=c.gridOptions[n].api.getFilterModel(),o=(0,i.v$)('[data-js="gflow-inbox"][data-grid-id="'.concat(n,'"]'),!1,document,!0)[0];0===Object.keys(e).length?o.classList.remove("gflow-inbox--filters-active"):o.classList.add("gflow-inbox--filters-active"),i.Xb.put(n,JSON.stringify(c.gridOptions[n].columnApi.getColumnState()))}(0,t)}),200,!1)}))},et=e(6588),it=function(){var t=arguments.length<=1?void 0:arguments[1],n=arguments.length<=2?void 0:arguments[2];return Math.sign(parseInt(t)-parseInt(n))},ot=function(){var t="object"===(0,et.Z)(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:new Date(1e3*(arguments.length<=1?void 0:arguments[1])),n=new Date(1e3*(arguments.length<=2?void 0:arguments[2])),e=0;return n.setDate(n.getUTCDate()),n.setMonth(n.getUTCMonth()),t.setHours(0,0,0,0),n.setHours(0,0,0,0),n<t?e=-1:n>t&&(e=1),void 0===(arguments.length<=5?void 0:arguments[5])?e:-1*e},at=function(t){var n=t.colDef.displayKey;return t.data[n]},ct=function(t){return t.valueFormatter=at,"string"===t.compareType?t:"date"===t.compareType?(t.comparator=ot.bind(null,t),t.filterParams={comparator:ot.bind(null,t),inRangeInclusive:!0},t.filter="agDateColumnFilter",t):(t.comparator=it.bind(null,t),t)},rt=e(5683),st=e.n(rt),dt=e(713),lt=e(8272),ut=e.n(lt),gt=e(7063),ft=e(1135),vt=e.n(ft),pt=e(5288),ht=e.n(pt),wt=e(2515),mt=e.n(wt),bt=null===v()||void 0===v()?void 0:v().endpoints,_t=function(){var t={};for(var n in bt){var e=bt[n];t[n]={endpoint:mt()("".concat(e.path).concat(e.rest_params)),nonce:e.nonce}}return t}(),yt=e(5237),xt=e(1822),kt=e(4938),At=e(9129),Ot=e(9969),jt=e(4019),Tt=e.n(jt),Mt=e(5559),Gt=e.n(Mt),Nt=e(9659),Et=e.n(Nt);function Lt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function It(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?Lt(Object(e),!0).forEach((function(n){(0,gt.Z)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Lt(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function Dt(t){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,dt.Z)(ut().mark((function t(n){var e,o,a,c,r,s,d,l,u,g,f,p,h,w=arguments;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=w.length>1&&void 0!==w[1]?w[1]:{},o=It({method:"GET"},e),a=(0,yt.Z)(["body"],o),n&&_t[n]){t.next=5;break}throw new Error("Unknown pathKey: ".concat(n));case 5:return c=a.baseUrl||v().site_url,r=_t[n].endpoint,(0,xt.Z)(Function,r)&&(r=_t[n].endpoint(It(It({},e.body),a.restParams))),console.log(c),s="".concat(c).concat(r),"GET"!==a.method&&"HEAD"!==a.method&&(d=e.body?e.body:{},a.body=(0,i.D$)(d)),a.json&&(a.body=JSON.stringify(a.json)),(l=a.params||{})&&!(0,kt.Z)(l)&&(u=ht()(l,vt()),g=(0,Ot.stringify)(u,{arrayFormat:"bracket"}),s="".concat(s,"?").concat(g)),f=_t[n].nonce?{"X-WP-Nonce":_t[n].nonce,"Content-Type":"application/json"}:{},p=a.headers?It(It({},f),a.headers):f,console.info("Fetching url: ".concat(s)),console.info("with options",It(It({},a),{},{body:a.body})),console.info("and headers: ",p),h=Date.now(),t.abrupt("return",window.fetch(s,It(It({},a),{},{headers:p})).then((function(t){return t.ok?t.text().then((function(e){try{var i=JSON.parse(e),o=Date.now()-h;return console.info("Data for ".concat(n," in ").concat(o,"ms:"),i),{data:i,status:t.status,totalPages:t.headers.get("x-wp-totalpages"),totalPosts:t.headers.get("x-wp-total")}}catch(n){var a=Gt()(Tt()(Et()(e))),c=new Error("Invalid server response. ".concat(a));throw c.detail={url:s,data:a,status:t.status,error:n},c}})):(0,At.Z)(t.headers.get("Content-Type"),"application/json")?t.text().then((function(e){try{var i=JSON.parse(e);return console.info("Data for ".concat(n,":"),i),{data:i,status:t.status}}catch(n){var o=Gt()(Tt()(Et()(e))),a=new Error("Invalid server response. ".concat(o));throw a.detail={url:s,data:o,status:t.status,error:n},a}})):t.text().then((function(n){var e=Gt()(Tt()(Et()(n))),i=new Error("Unknown server response. ".concat(e));throw i.detail={url:s,data:e,status:t.status},i}))})).catch((function(t){return console.info(JSON.stringify(t)),console.info(t.detail),{error:t}})));case 21:case"end":return t.stop()}}),t)}))),Ct.apply(this,arguments)}var St=window.gravityflow_inbox_strings||{},qt=function(){var t=(0,dt.Z)(ut().mark((function t(n,e,i,o){return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Dt("inbox/preferences",{method:"PUT",headers:{"X-WP-Nonce":null==St?void 0:St.nonce,"Content-type":"application/json; charset=UTF-8"},json:{key:n,value:e,type:i,user_id:v().user_id,view:o}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(n,e,i,o){return t.apply(this,arguments)}}(),Rt=(null===v()||void 0===v()?void 0:v().grids)||{},Pt=(null===v()||void 0===v()?void 0:v().i18n)||{},Ht=function(t,n){var e=c.gridOptions[t].api,i=0;e.forEachNode((function(){i++}));var o=n.add.length-n.remove.length+n.update.length;a.newRowsOnUpdate=a.newRowsOnUpdate+(o-i)},Ut=function(t){if(t&&Rt[t].push_enabled){var n=c.gridOptions[t].api.getDisplayedRowCount();if(n!==a.previousRowCount){var e=a.latestUpdateData.add[0],i="noti-".concat(e.id);c.notifications[i]=new window.Notification(Pt.inbox_notification_title,{body:Pt.new_inbox_items}),a.previousRowCount=n,c.notifications[i].addEventListener("click",(function(t){a.latestUpdateData.add.length>1?(window.parent.focus(),window.focus(),t.target.close()):window.open(e.url_entry,i).focus()}),!1)}}},Zt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(st().now())return a.newRowsOnUpdate=0,void(document.title=a.cleanDocTitle);a.newRowsOnUpdate>0?(document.title="(".concat(a.newRowsOnUpdate,") ").concat(a.cleanDocTitle),Ut(t)):document.title=a.cleanDocTitle},Ft=function(t,n){"granted"===t?(qt("push_enabled",!0,"view",n),Rt[n].push_enabled=!0):(qt("push_enabled",!1,"view",n),Rt[n].push_enabled=!1)},$t=e(147),zt=(null===v()||void 0===v()?void 0:v().grids)||{},Jt=(null===v()||void 0===v()?void 0:v().i18n)||{},Kt=function(t){"inbox-setting--push-enabled"===t.delegateTarget.name&&function(t){if("Notification"in window){var n=(0,i.As)(t,".gform-flyout").previousElementSibling;t.checked?(0,i.Qg)()?window.Notification.requestPermission().then((function(t){Ft(t,n.dataset.gridId)})):window.Notification.requestPermission((function(t){Ft(t,n.dataset.gridId)})):(qt("push_enabled",!1,"",n.dataset.gridId),Rt[n.dataset.gridId].push_enabled=!1)}else alert(Pt.browser_notifications_error)}(t.delegateTarget)},Xt=(null===v()||void 0===v()?void 0:v().grids)||{},Wt=(null===v()||void 0===v()?void 0:v().i18n)||{},Bt=function(t){var n,e=_(t);null!==(n=Xt[e])&&void 0!==n&&n.grid_options||console.error("".concat(Wt.options_for_grid_not_found," ").concat(e)),c.gridOptions[e]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p;return(0,g.Z)({},w[t].grid_options,h)}(e),Xt[e].push_enabled&&(a.pushEnabled=!0),c.gridOptions[e].overlayNoRowsTemplate='<span class="ag-overlay-no-rows-center">'.concat(Wt.no_entries,"</span>"),nt(e),c.gridOptions[e].getRowNodeId=function(t){return parseInt(t.id)},c.gridOptions[e].components={actionsRenderer:Z,agDateInput:G},c.gridOptions[e].getRowStyle=function(t){if(t.data.step_highlight)return{borderLeft:"3px solid ".concat(t.data.step_highlight)}},c.gridOptions[e].columnDefs.forEach((function(t,n){c.gridOptions[e].columnDefs[n]=ct(t)})),c.grids[e]=new A.rj(t,c.gridOptions[e]),function(t){t.insertAdjacentHTML("afterbegin",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.EL)("inbox-header-");return'\n\t<div class="gflow-grid__header">\n\t\t<i class="gflow-grid__search-icon gflow-icon gflow-icon--search"></i>\n\t\t'.concat(q("search",t,"","","gform-input gflow-inbox__search","gflow-inbox-search",P.search_inbox),"\n\t</div>\n\t")}())}(t),function(t,n){t.insertAdjacentHTML("afterbegin",function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return'\n\t<button \n\t\tclass="gflow-grid__button gflow-grid__button--settings gflow-icon gflow-icon--settings" \n\t\tdata-js="'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"grid-settings",'" \n\t\ttitle="').concat(t,'"\n\t></button>\n\t')}("inbox-settings",Jt.toggle_settings_title)),t.insertAdjacentHTML("afterbegin",function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return'\n\t<button \n\t\tclass="gflow-grid__button gflow-grid__button--fullscreen gflow-icon gflow-icon--maximize-2" \n\t\tdata-js="'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"grid-fullscreen",'" \n\t\ttitle="').concat(t,'"\n\t></button>\n\t')}("inbox-fullscreeen",Jt.toggle_fullscreen_title)),t.insertAdjacentHTML("afterbegin",function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return'\n\t<button \n\t\tclass="gflow-grid__button gflow-grid__button--clear-filters gflow-icon gflow-icon--trash" \n\t\tdata-js="'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"grid-clear-filters",'" \n\t\ttitle="').concat(t,'"\n\t></button>\n\t')}("inbox-clear-filters",Jt.toggle_clear_filters_title)),c.flyouts[n]=new $t.Z({content:H(zt[n]),maxWidth:650,position:"absolute",target:".gflow-inbox.gflow-grid",title:Jt.inbox_settings,triggers:'[data-js="inbox-settings"]',wrapperClasses:"gform-flyout gform-flyout--inbox-settings"})}(t,e),setTimeout((function(){t.classList.add("gflow-inbox--reveal"),t.parentElement.classList.add("gflow-inbox--reveal"),setTimeout((function(){var n=(0,i.v$)("gflow-inbox-loader",!1,t.parentElement.parentElement)[0];n.parentNode.removeChild(n)}),200)}),300)},Qt=(null===v()||void 0===v()?void 0:v().grids)||{},Vt=Object.keys(Qt)[0]||p,Yt=function(){var t=(0,dt.Z)(ut().mark((function t(n){var e,i,o,r,s;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=m(n),t.next=3,Dt("inbox/changes",{method:"POST",body:{gflow_access_token:(null===(e=Qt[Vt])||void 0===e?void 0:e.current_user_token)||null,current_ids:r,search_args:JSON.stringify((null===(i=Qt[Vt])||void 0===i||null===(o=i.grid_options)||void 0===o?void 0:o.searchArgs)||null)}});case 3:s=t.sent,a.latestUpdateData=s.data,Ht(n,s.data),s.data.addIndex=0,c.gridOptions[n].api.applyTransaction(s.data);case 8:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),tn=function(t){o.containers=t,o.containers.forEach((function(t){return Bt(t)})),o.containers.forEach((function(t){Qt[t.dataset.gridId].fetch_enabled&&(c.refreshTimers[t.dataset.gridId]=setInterval((function(){Yt(t.dataset.gridId).then((function(){Zt(t.dataset.gridId)}))}),1e3*Qt[t.dataset.gridId].fetch_interval))})),document.addEventListener("keydown",I),document.addEventListener("keyup",I),(0,i.cl)(document.body,'[data-js="gflow-quick-actions-trigger"]',"click",V),(0,i.cl)(document.body,'[data-js="gflow-quick-actions-menu-trigger"]',"click",J),(0,i.cl)(document.body,'[data-js="gflow-quick-actions-menu-note"]',"keyup",K),(0,i.cl)(document.body,'[data-js="gflow-quick-actions-menu-note-action"]',"click",X),document.addEventListener("click",Y),window.addEventListener("resize",tt),(0,i.cl)(document.body,'[data-js="inbox-setting"]',"click",Kt),(0,i.cl)(document.body,'[data-js="inbox-fullscreeen"]',"click",l),document.addEventListener("keydown",u),(0,i.cl)(document.body,'[data-js="inbox-clear-filters"]',"click",r),(0,i.cl)(document.body,'[data-js="gflow-inbox-search"]',"keyup",x),(0,i.cl)(document.body,'[data-js="gflow-inbox-search"]',"search",k),o.containers.forEach((function(t){var n=(0,i.v$)(".ag-center-cols-viewport",!1,t,!0)[0];(0,i.kN)(n)})),document.addEventListener("gform-utils/horizontal-drag-started",(function(){a.dragging=!0})),document.addEventListener("gform-utils/horizontal-drag-ended",(function(){setTimeout((function(){a.dragging=!1}),200)})),st().on("focus",(function(){a.notificationShown=!1,Zt()})),st().on("blur",(function(){a.openInNewTab=!1})),a.pushEnabled&&void 0!==window.Notification&&"granted"!==window.Notification.permission&&window.Notification.requestPermission(),console.info("Gravity Flow Common: Initialized inbox components.")}}}]);